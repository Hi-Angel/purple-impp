#include <variant>
#include <cstring>
#include <vector>
#include <iterator>
#include "common-consts.h"
#include "protocol.h"

using namespace std;

int main(int argc, char *argv[]) {
    // const uint8_t request[] = {0x6f, 0x02, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x80,
    //                            0xf7, 0x26, 0x86, 0x00, 0x00, 0x00, 0x06, 0x00, 0x01,
    //                            0x00, 0x02, 0x00, 0x03};
    // const uint8_t request2[]= {0x6f, 0x02, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00,
    //                            0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x06, 0x00, 0x01,
    //                            0x00, 0x02, 0x00, 0x03};
    // const uint8_t request3[] = {0x6f, 0x02, 0x00, 0x00, 0x00, 0x01, 0x00, 0x02, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x1c, 0x00, 0x02, 0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x06, 0x74, 0x72, 0x69, 0x63, 0x69, 0x61, 0x00, 0x03, 0x00, 0x08, 0x70, 0x61, 0x73, 0x73, 0x77, 0x6f, 0x72, 0x64};
    // print_tlv_packet(request, sizeof(request));
    // print_tlv_packet(request2, sizeof(request2));
    // print_tlv_packet(request3, sizeof(request3));

    const char* name = "myname";
    const char* pass = "mypass";
    tlv_packet_data auth = templ_authorize;
    auth.set_tlv_val(1, vector<uint8_t>{name, name + strlen(name)});
    auth.set_tlv_val(2, vector<uint8_t>{pass, pass + strlen(pass)});
    print_tlv_packet_data(auth);
    const std::vector<uint8_t> dat_auth = serialize(auth);
    print_tlv_packet(dat_auth.data(), dat_auth.size());

}
